<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
	http://www.springframework.org/schema/security
	http://www.springframework.org/schema/security/spring-security.xsd">
		
	<!-- This is for security purposes -->
		
  <!--      
 <beans:bean class="org.springframework.security.web.access.expression.DefaultWebSecurityExpressionHandler"/>
<beans:bean id="webSecurityExpressionHandler" class="org.springframework.security.web.access.expression.DefaultWebSecurityExpressionHandler" />  
   <http  use-expressions="true">
     
   <intercept-url pattern="/login*" access="permitAll" />
   <access-denied-handler ref="my403" />
	
	<intercept-url pattern="/application_control*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/global_settings*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/wallet*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/message*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/trading*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/gifting*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/notifications*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/users*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/searchByStatusUser*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	
	<intercept-url pattern="/reports*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/home_reports*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/searchUserByDate*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/searchByUserCountry*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/searchByCountry*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/searchByPaymentMethod*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	
	
	<intercept-url pattern="/activity_log*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/searchByUser*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/search_status_wallet*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	
	<intercept-url pattern="/change_password*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	
	<intercept-url pattern="/admin_log*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/search_user*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/vmoney_log*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	<intercept-url pattern="/vmoney_logs*" access="hasAnyRole('ROLE_USER', 'ROLE_ADMIN')" />
	
	<intercept-url pattern="/admin_users*" access="hasAnyRole('ROLE_ADMIN')" /> 
		
		<form-login 
		    login-page="/login.html"  username-parameter="username"
			password-parameter="password"
			default-target-url="/process_user.html" 
			authentication-failure-url="/login.html?error"
			 authentication-success-handler-ref="myAuthenticationSuccessHandler"
			 authentication-details-source-ref="webSecurityExpressionHandler"/>
			 
		<logout logout-success-url="/login.html?logout"  />
		
		<logout delete-cookies="JSESSIONID" />
   	    <remember-me key="uniqueAndSecret" token-validity-seconds="86400" />
   	    
   	    
   	    <custom-filter position="CONCURRENT_SESSION_FILTER" ref="concurrencyFilter" />
	    <custom-filter after="FORM_LOGIN_FILTER" ref="myAuthFilter"  />
	
	    <session-management session-authentication-strategy-ref="sas"/>
	</http>
	
	 <beans:bean id="my403"
		class="com.cheers.controller.MyAccessDeniedHandler">
		<beans:property name="errorPage" value="403.html" />
	</beans:bean> 
	  
	 <beans:bean id="myAuthenticationSuccessHandler"
        class="com.cheers.controller.MySimpleUrlAuthenticationSuccessHandler" />
 
	<authentication-manager alias="authenticationManager" >
			<authentication-provider>
			 <jdbc-user-service data-source-ref="dataSource"
				  users-by-username-query=	
				    "select username, password, enabled from cheers.user_admins where username=?"
				  authorities-by-username-query=
				    "select username, role from cheers.user_roles where username = ?"/>
		</authentication-provider>
	</authentication-manager>


	  <beans:bean id="concurrencyFilter"
	      class="org.springframework.security.web.session.ConcurrentSessionFilter">
	    <beans:property name="sessionRegistry" ref="sessionRegistry" />
	    <beans:property name="expiredUrl" value="/login_expired.html" />
	  </beans:bean>
	
	  <beans:bean id="myAuthFilter"
	      class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter">
	    <beans:property name="sessionAuthenticationStrategy" ref="sas" />
	    <beans:property name="authenticationManager" ref="authenticationManager" />
	    
	    
	  </beans:bean>
	
	  <beans:bean id="sas"
	      class="org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy">
	    <beans:constructor-arg name="sessionRegistry" ref="sessionRegistry" />
	    <beans:property name="maximumSessions" value="1" />
	  </beans:bean>
	
	  <beans:bean id="sessionRegistry" class="org.springframework.security.core.session.SessionRegistryImpl" /> -->
	

</beans:beans>
